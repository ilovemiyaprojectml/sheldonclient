var icons = module.exports;

var selected = 'chevron';
var tpl = document.querySelector('#iconbox');
var list = document.querySelector('#icon-list');
var total = document.querySelector('#total');
var aside = document.querySelector('aside');
var asideTitle = aside.querySelector('#title');
var asideItems = aside.querySelectorAll('li');

total.innerHTML = icons.length;

icons.forEach(([icon, keycode]) => {
  tpl.content.querySelector('.iconbox').id = 'id-' + icon;
  tpl.content.querySelector('.iconbox').dataset.icon = icon;
  tpl.content.querySelector('i').className = 'fis-icon-' + icon;
  tpl.content.querySelector('.label').innerHTML = icon;
  list.appendChild(document.importNode(tpl.content, true));
});

list.querySelectorAll('.iconbox').forEach(box => {
  box.addEventListener('click', select);
});

function unloadAside() {
  aside.style.visibility = 'hidden';
  asideItems.forEach(li => {
    li.querySelector('i').classList.remove('fis-icon-' + selected);
  });
}

function _clearSelection() {
  aside.style.visibility = 'hidden';
  asideItems.forEach(li => {
    li.querySelector('i').classList.remove('fis-icon-' + selected);
  });
  list.querySelector('#id-' + selected).classList.remove('selected');
}

function select(name) {
  name = (this.dataset && this.dataset.icon) || name;
  _clearSelection();
  _performSelection(name);
}

function _performSelection(name) {
  selected = name;
  list.querySelector('#id-' + selected).classList.add('selected');
  asideTitle.innerHTML = 'fis-icon-' + selected;
  asideItems.forEach(li => {
    li.querySelector('i').classList.add('fis-icon-' + selected);
  });
  aside.style.visibility = 'initial';
  document.body.scrollIntoView();
}

select('chevron');
