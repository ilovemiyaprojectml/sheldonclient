# Dynamic Menubar

The RUF Dynamic Menubar component is a metadata component that will take view metadata (path, label, children) as @input and provide a select @output.
It renders multiple menu items and allows the user to select one.

The Dynamic Menubar uses `mat-tab-group` from Material to render the list of items. However, it is only used to render the menubar header. Rendering the content of the selected item is out of scope of the Dynamic Menubar.

[]()                 | []()
-------------------- | --------------------
Selector             | ruf-dynamic-menubar
Class Name           | RufDynamicMenubarComponent
Module name          | RufDynamicMenubarModule
Presentational       | Yes
FIS UX Guidelines    | [NavBar](https://ux.fisglobal.com/ux/menutouch.html#/navbar)
Dependencies         | NA

## Appearance and Behavior

The component is a container for clickable menubar items. Each item can be selected on click and become activated.
An activated item will have an "ink bar" to visually identify the activated state of that item.
A menubar can be used horizontally or vertically.

Clicking on an item (selecting) doesn't necessarily activate the item. The activation of the item can be controlled externally using the selectedPath property binding.

One item will always be selected. By default first item will selected and if the first item is with child menu, then first child will be selected by default.

### Styling

Most of the menu styling will be inherited from its parent, ex. height, fonts.

Colors are, by default, inherited from the parent. You can declaratively define the inkbar color using the activatedColor input.

Variable                             | Default           | Description
------------------------------------ | ----------------- | -----------
$ruf-dynamic-menubar-height          | ruf-to-rem($ruf-vunit * 44px) | Adjust the height of the dynamic-menubar.

Helper Classes                       | Description
------------------------------------ | -----------
ruf-dynamic-menubar-flex-height      | If this class is used on the component element, the height and line-height will be inherited. The dynamic-menubar will therefore adapt its height as long as the element it is put in declares identical height and line-height.

### Responsiveness

The dynamic menubar will have some adaptiveness features in the future: it will provide an overflow dropdown when the items cannot be displayed in the available space.
Other aspects should be controlled using the direction input and the [RUF layout directives](https://wiki.fnis.com/x/ifX4WgI).

## Accessibility

This component assigns a role attribute of menubar to the ruf-dynamic-menubar element and a role of menuitem to each of the items.

The menubar component also participates in tabbed navigation. The individual items however do not. You instead need to use keyboard navigation (future) to assign focus and select an item.

See [ARIA Guidelines](https://www.w3.org/WAI/GL/wiki/Using_ARIA_menus) for menus

### Future considerations:
- aria-haspopup (does the item have a dropdown that it opens)

Keyboard Support (Expected accessibility behavior for keyboard users):
- Left arrow: Next menubar item
- Right arrow: Previous menubar item
- Up arrow: Open pull down menu and select first menu item
- Down arrow: Open pull down menu and select first menu item
- Enter: Open or close pull down menu. Select first menu item if opening
- Space: Open or close pull down menu. Select first menu item if opening

## Internationalization

The ARIA label for `Close` icon can be localized using two ways.
  1. The component uses `dynamicmenubar.aria.closeAriaLabel` from `RufShellIntl` for default value. Provide your own implementation of this class to override this value. For more information, check `String Translations` section from I18n documentation.
  2. Use `closeAriaLabel` attribute. This takes precedence over the `RufShellIntl` provider.

  ```html
  <!-- ARIA Label is 'Click to close menuitem'. -->
  <ruf-dynamic-menubar ... [closeAriaLabel]="'Click to close menuitem'">...</ruf-dynamic-menubar>

  <!-- ARIA Label is 'Close' which is default value from RufShellIntl. -->
  <ruf-dynamic-menubar>...</ruf-dynamic-menubar>
  ```

## Inputs

### items

Type: RufDynamicMenubarItem

The collection to be rendered. An item has following attributes:

| Property | Type | Description |
| ---- | ---- | ----------- |
| label | string | Required. The display name for the item. |
| path | string | Required. Path to uniquely identify this item |
| children | RufDynamicMenubarItem[] | Children of this item, if any. Will be rendered as a dropdown menu when clicked |
| icon | string | Icon to be placed to the left of the label text |
| params | object | Optional. Params to be passed to the select output emitter for this item |

Note: Dynamic Menubar uses `OnPush` change detection strategy due to that angular runs change detection cycle for this component only when input properties of this component changes so, on updating items variable that bound to items input, the reference of items variable will never change, so change detection will never performed for this component and changes will not reflect in DOM. To let angular know about this change user need to create a new instance(reference) of updated items variable and assign it to items input.

### selectedPath

Type: string

Optional. Use this property to control the item that should be activated.

A path is simply an identifier for an item. Each menu item will use a "startsWith" matching strategy to determine if it is active or not.
This means that if you have an item with a path of users and on with 'users/me' and provide a selectedPath of 'users/me', both items will be activated.

Note: changing this property fires select event.

### activeColor

Type: string

Optional. You can provide the color to be used to identify activated items.
Use one of the theme color names: primary, accent (default), emphasis.

### closeAriaLabel
Type: string

It sets aria-label attribute for close icon.

### type
Type: NavType(enum)

If value is passed as `tabs` then dynamic-menubar renders as [tabs](https://ux.fisglobal.com/uxtest/menutouch.html#/tabs).
Possible values are `nav` and `tabs`.

Default: `nav`

## Outputs

### select

A RufDynamicMenubarItem object is fired on clicking an item in the menu. The `$event` will therefore be the selected item from the input `items`:

| Property | Type | Description |
| ---- | ---- | ----------- |
| label | string | Required. The display name for the item. |
| path | string | Required. Path to uniquely identify this item |
| children | RufDynamicMenubarItem[] | Children of this item, if any. Will be rendered as a dropdown menu when clicked |
| icon | string | Icon to be placed to the left of the label text |

## Examples:

### Simple Dynamic Menubar

```html
<ruf-dynamic-menubar [items]="items">
</ruf-dynamic-menubar>
```

### Dynamic Menubar with selectedPath

```html
<ruf-dynamic-menubar [items]="items" [selectedPath]="selectedPath">
</ruf-dynamic-menubar>
```

### Dynamic Menubar with select

```html
<ruf-dynamic-menubar [items]="items" (select)="handleSelection($event)">
</ruf-dynamic-menubar>
```

### Dynamic Menubar with Actions

```html
<ruf-dynamic-menubar [items]="items">
    <ng-template let-item="item">
      <button *ngIf="item.label === 'Item 2'" mat-icon-button (click)="item2ActionClicked()" rufIconButton>
        <mat-icon fisIcon="help"></mat-icon>
      </button>
    </ng-template>
  </ruf-dynamic-menubar>
```

### Sample Metadata

```json
items: RufDynamicMenubarItem[] = [
    {
      label: 'Item 1',
      path: 'item1',
      icon: 'fis-icon-dashboard',
      children: [
        {
          label: 'Child 1',
          path: 'item1/child1'
        },
        {
          label: 'Child 2',
          path: 'item1/child2'
        }
      ]
    },
    {
      label: 'Item 2',
      path: 'item2'
    },
    {
      label: 'Item 3',
      path: 'item3',
      icon: 'fis-icon-settings',
    }
]
```

### Dynamic menubar as tabs

```html
<ruf-dynamic-menubar type="tabs" [items]="items" [selectedPath]="selectedPath">
</ruf-dynamic-menubar>
```

## Methods


## RufDynamicNavType
`RufDynamicNavType` is an enum which indicates different navigation types of dynamic-menubar.
Following are the valid values.
Nav = 'nav',
Tabs = 'tabs'
