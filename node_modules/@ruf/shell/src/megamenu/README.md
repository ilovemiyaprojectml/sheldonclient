# Megamenu
The Megamenu is a searchable menu housed in a container.
Menu items can link to pages or to predefined filters.

[]()                 | []()
-------------------- | --------------------
Selector             | ruf-megamenu
Class name           | RufMegamenuComponent
Module name          | RufMegamenuModule
Presentational       | Yes
FIS UX Guidelines    | [Megamenu](https://ux.fisglobal.com/ux/menutouch.html#/megamenu)
Internationalized    | Yes
Dependencies         | RufToolbarModule, RufSidemenuModule, RufSitemapModule, RufUtilsModule

## Appearance and Behavior
The component consists of three different parts:
* search input - Search field with clear functionality that filters the navigation items in the sitemap. See below for more information about the search.
* sidemenu - Side menu containing the highest level parent navigation items used to filter the navigation items 
* sitemap - Responsive flex box containing navigation links grouped under their respective parent categories. Each item is clickable and emits an event that contains the item label and path provided by the navigation data structure. See the sitemap component readme for more information.

## Styling
The megamenu has been styled according to the FIS standards [https://ux.fisglobal.com/ux/index.html]

Variable                      | Default                                    | Description
----------------------------- | ------------------------------------------ | -----------
$ruf-megamenu-color           | ruf-color($foreground, text)               | Text color of the megamenu.
$ruf-sitemap-container        | ruf-color($background, card);              | Background color of the megamenu.
$ruf-side-megamenu-background | ruf-color($background, side-megamenu)      | Background color of the sidemenu in the megamenu.
$ruf-menubar-highlight-color  | lighten($ruf-side-megamenu-background, 5%) | The highlight color of items in the megamenu's sidemenu.
$ruf-scrollbar-color          | darken($ruf-side-megamenu-background, 20%) | Color of the overflow scroll bar for the sidemenu and sitemap.
$ruf-search-item-active-color | ruf-color($accent)                         | Accent color for the search input focus highlighting. This matches the accenting in the sidemenu items when they are selected.

## Responsiveness
The number of results columns depends on the screen width. Small screen devices like mobile phones are not currently supported.

### For the future
For small screen devices the megamenu layout is still to be decided. 

## Accessibility

### ARIA Attributes
This component assigns a role attribute of menubar to the ruf-megamenu element and a role of menuitem to each of the items.

See [ARIA Guidelines](https://www.w3.org/WAI/GL/wiki/Using_ARIA_menus) for menus

### Keyboard Accessibility
Keyboard navigation is implemented according to ARIA Guidelines.
After tabbing into the sidemenu the following applies:
* `UP-ARROW` or `LEFT-ARROW` moves focus upward within the sidemenu, and recycles focus to the bottom of the sidemenu if pressed on the top-most item
* `DOWN-ARROW` or `RIGHT-ARROW` moves focus downwards within the sidemenu, and recycles focus to the top of the sidemenu if pressed on the bottom-most item
* `SPACE` or `ENTER` will select the focused sidemenu item and update the sitemap

### Order of navigation
After the megamenu has been opened (nothing receives focus immediately), pressing `TAB` to change focus follows the subsequent order:
1. search input
2. search clear-icon
3. sidemenu first item
4. sitemap
5. off the megamenu

## Internationalization

The ARIA label and Placeholder can be localized using two ways.
  1. The component uses `megamenu.aria.clearSearchLabel` and `megamenu.placeholder` from `RufShellIntl` for default value. Provide your own implementation of this class to override this value. For more information, check `String Translations` section from I18n documentation.
  2. Use `searchPlaceholder` and `clearSearchAriaLabel` attributes. This takes precedence over the `RufShellIntl` provider.
  ```html
  <!-- Placeholder is 'search in megamenu' and ARIA label value is 'clear megamenu search' -->
  <ruf-megamenu [searchPlaceholder]="'search in megamenu'" [clearSearchAriaLabel]="'clear megamenu search'"></ruf-megamenu>

  <!-- Placeholder is 'Search' and ARIA label value is 'Clear search' which is default value from RufShellIntl -->
  <ruf-megamenu>...</ruf-megamenu>
  ``` 

## Inputs

### items
The Megamenu is configured according to an @Input items, the data is determined by the application and must follow the following convention:
```json
[
    {
      label:"Cats",
      path: "path/subpath1"
     },
     {
      label:"More Cats",
      path: "path/subpath2"
     },
     {
      label:"Even More Cats",
      path: "path/subpath3",
      children: [
        {
          label:"Kittens",
          path: "path/subpath4"
        }
      ]
     }
]
```
It is important to note that the megamenu doesn't do any routing itself, the path is rather passed to the $event that is fired upon selecting a sitemap item.

### searchPlaceholder
The search placeholder replaces the placeholder text shown in the search input in the megamenu.

### clearSearchAriaLabel

ARIA label for clear search button.

## Outputs

### select
The menu item object that is selected by the user fires a selection event and passes it to the specified function.

Example:

```html
<ruf-megamenu [items]="myItems" (select)="doSomething($event)"></ruf-megamenu>
<ruf-megamenu [items]="myItems" (select)="selectedPath = $event.path"></ruf-megamenu>
```

## Examples

### Simple Example
```html
<ruf-slider>
  <ruf-megamenu>
  </ruf-megamenu>
</ruf-slider>
```

### Routing Example
app.component.html
```html
    <ruf-megamenu [items]="myItems" (select)="open($event.path)"></ruf-megamenu>
```

app.component.ts
```javascript
class AppComponent {
    open(path: string) {
        return this.router.navigateByUrl(path);
    }
}
```

# Megamenu Search Component
The Megamenu Search component provides a search input with a clear button for use in the Megamenu.
It has not been exported so it is not available outside the scope of the megamenu template or class.

[]()                 | []()
-------------------- | --------------------
Selector             | ruf-megamenu-search
Class Name           | RufMegamenuSearchComponent
Module Name          | RufMegamenuModule
Presentational       | Yes
FIS UX Guidelines    | NA
Dependencies         | NA

## Appearance and Behavior

Typing in the Search area displays filtered results in the results pane.

### Styling
Colors are inherited from the parent.

## Accessibility
### ARIA Attributes
This component assigns an aria label to its input and clear icon, and assigns a tabindex to the clear icon to include it in the tab through sequence.

### Keyboard Accessibility
Keyboard navigation is implemented according to ARIA Guidelines. 
After tabbing into the search input the following applies: 
* `ENTER` on the search input will update the sitemap
* `TAB` will move selection from the input onto the clear icon, pressing it again will move selection onto the sidemenu
* `ENTER` or `SPACE` on the clear icon will clear the search input and update the sitemap
* `SHIFT+TAB` will return selection to the clear icon and then to the search input

The search input will also automatically update the sitemap when other keys are pressed constantly giving the matching sitemap items. 

## Internationalization

The ARIA label and Placeholder can be localized using two ways.
  1. The component uses `megamenusearch.aria.clearSearchLabel` and `megamenusearch.placeholder` from `RufShellIntl` for default value. Provide your own implementation of this class to override this value. For more information, check `String Translations` section from I18n documentation.
  2. Use `placeholder` and `clearSearchLabel` attributes. This takes precedence over the `RufShellIntl` provider.
  ```html
  <!-- Placeholder is 'search in megamenu' and ARIA label value is 'clear megamenu search' -->
  <ruf-megamenu-search [placeholder]="'search in megamenu'" [clearSearchLabel]="'clear megamenu search'"></ruf-megamenu>

  <!-- Placeholder is 'Search' and ARIA label value is 'Clear search' which is default value from RufShellIntl -->
  <ruf-megamenu>...</ruf-megamenu>
  ``` 


## Inputs

### placeholder

Type: string

Optional. Use this property to set the placeholder text. Default is an empty string.
 
### clearSearchLabel
Type: string

ARIA label for clear search button.


## Outputs

### filterValue

A filter value changed event is fired when the input value changes or the clear button is clicked. 
The $event object is just a string containing the contents of the input e.g. 'hello'

Example:

```html
<ruf-megamenu-search (filterValue)="doSomething($event)"></ruf-megamenu-search>
<ruf-megamenu-search (filterValue)="inputValue = $event"></ruf-megamenu-search>
```
