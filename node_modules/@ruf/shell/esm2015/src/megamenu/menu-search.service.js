import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
// the object we reduce into during search preparation
export class RufCart {
}
let RufSearchService = class RufSearchService {
    constructor() {
        this.SPLITTER = String.fromCharCode(167);
    }
    recursiveReduce(items, context) {
        return items.reduce((cart, item) => {
            if (item.children && item.children.length > 0) {
                // this is a parent
                const newContext = context.concat([item.label]);
                const childCart = this.recursiveReduce(item.children, newContext);
                // we need to add a parent object with this objects children
                const parent = {
                    label: item.label,
                    path: item.path,
                    context: context.join(', '),
                    children: childCart.children,
                    searchKey: childCart.searchKeys.join(this.SPLITTER) // only searchkeys of non-parent nodes
                };
                // only add this parent, if it has children
                if (childCart.children && childCart.children.length > 0) {
                    cart.parents.push(parent);
                }
                // we get the parent nodes from the children of this item and only pass these up
                cart.parents = cart.parents.concat(childCart.parents); // the reduced items are basically pushed up to the highest level
                // we also append the childcart keys to the parent (for searching purposes)
                // This isn't necessary anymore as we only have one level cart.searchKeys = cart.searchKeys.concat(childCart.searchKeys);
            }
            else {
                // this is a child, so we add it to this carts children
                item.searchKey = item.label.toLowerCase(); // we make the search key lowercase here for all children
                cart.children.push(item);
                cart.searchKeys.push(item.searchKey);
            }
            return cart;
        }, {
            // start with an empty cart
            parents: [],
            children: [],
            searchKeys: []
        });
    }
    // prepares the search items
    prepareSearch(items) {
        // the goal is to recursively parse the tree structure for parents of children
        // children are nodes with no children, parents are nodes with children
        const preparedItems = this.recursiveReduce(items, []);
        // we return a function here that performs the search on the prepared items
        return term => {
            return this.performSearch(preparedItems.parents, term);
        };
    }
    // used to create a reduced version of what gets displayed, and also
    // detaches from the original object
    copySearchItem(item, newChildren) {
        return {
            label: item.label,
            path: item.path,
            context: item.context,
            children: newChildren
        };
    }
    // The search assumes that there each item in the array only has one level of children
    // this explicit structure is created in the prepare search
    performSearch(items, term) {
        const searchTerm = term.toLowerCase(); // lowercase search term vs lowercase search key
        // call the reduce to omit non matching items
        return items.reduce(
        // newItems is the returned value from the prev function call
        (newItems, item) => {
            // first we check if the parent item will be added (checking this here prevents unnecessary looping)
            if (item.searchKey && item.searchKey.indexOf(searchTerm) > -1) {
                // filter the children
                // (we know there are children as the searchkey collates only child keys)
                const reducedChildren = item.children.filter(child => {
                    return child.searchKey.indexOf(searchTerm) > -1;
                });
                // there will always be atleast one child that matches
                // (as have already we checked the collated search key)
                newItems.push(this.copySearchItem(item, reducedChildren));
            }
            return newItems;
        }, [] // initial empty array
        );
    }
};
RufSearchService = tslib_1.__decorate([
    Injectable()
], RufSearchService);
export { RufSearchService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVudS1zZWFyY2guc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BydWYvc2hlbGwvIiwic291cmNlcyI6WyJzcmMvbWVnYW1lbnUvbWVudS1zZWFyY2guc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUkzQyxzREFBc0Q7QUFDdEQsTUFBTSxPQUFPLE9BQU87Q0FJbkI7QUFHRCxJQUFhLGdCQUFnQixHQUE3QixNQUFhLGdCQUFnQjtJQUQ3QjtRQUVVLGFBQVEsR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBd0Y5QyxDQUFDO0lBdEZDLGVBQWUsQ0FBQyxLQUFzQixFQUFFLE9BQWlCO1FBQ3ZELE9BQU8sS0FBSyxDQUFDLE1BQU0sQ0FDakIsQ0FBQyxJQUFhLEVBQUUsSUFBbUIsRUFBRSxFQUFFO1lBQ3JDLElBQUksSUFBSSxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7Z0JBQzdDLG1CQUFtQjtnQkFDbkIsTUFBTSxVQUFVLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO2dCQUNoRCxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsVUFBVSxDQUFDLENBQUM7Z0JBQ2xFLDREQUE0RDtnQkFDNUQsTUFBTSxNQUFNLEdBQUc7b0JBQ2IsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLO29CQUNqQixJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUk7b0JBQ2YsT0FBTyxFQUFFLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO29CQUMzQixRQUFRLEVBQUUsU0FBUyxDQUFDLFFBQVE7b0JBQzVCLFNBQVMsRUFBRSxTQUFTLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLENB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LENBQUM7Q0FDRixDQUFBO0FBekZZLGdCQUFnQjtJQUQ1QixVQUFVLEVBQUU7R0FDQSxnQkFBZ0IsQ0F5RjVCO1NBekZZLGdCQUFnQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IFJ1ZlNlYXJjaEl0ZW0gfSBmcm9tICcuL3NlYXJjaC9zZWFyY2hpdGVtLmludGVyZmFjZSc7XG5cbi8vIHRoZSBvYmplY3Qgd2UgcmVkdWNlIGludG8gZHVyaW5nIHNlYXJjaCBwcmVwYXJhdGlvblxuZXhwb3J0IGNsYXNzIFJ1ZkNhcnQge1xuICBwYXJlbnRzOiBSdWZTZWFyY2hJdGVtW107XG4gIGNoaWxkcmVuOiBSdWZTZWFyY2hJdGVtW107XG4gIHNlYXJjaEtleXM6IHN0cmluZ1tdO1xufVxuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgUnVmU2VhcmNoU2VydmljZSB7XG4gIHByaXZhdGUgU1BMSVRURVIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDE2Nyk7XG5cbiAgcmVjdXJzaXZlUmVkdWNlKGl0ZW1zOiBSdWZTZWFyY2hJdGVtW10sIGNvbnRleHQ6IHN0cmluZ1tdKTogUnVmQ2FydCB7XG4gICAgcmV0dXJuIGl0ZW1zLnJlZHVjZTxSdWZDYXJ0PihcbiAgICAgIChjYXJ0OiBSdWZDYXJ0LCBpdGVtOiBSdWZTZWFyY2hJdGVtKSA9PiB7XG4gICAgICAgIGlmIChpdGVtLmNoaWxkcmVuICYmIGl0ZW0uY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xuICAgICAgICAgIC8vIHRoaXMgaXMgYSBwYXJlbnRcbiAgICAgICAgICBjb25zdCBuZXdDb250ZXh0ID0gY29udGV4dC5jb25jYXQoW2l0ZW0ubGFiZWxdKTtcbiAgICAgICAgICBjb25zdCBjaGlsZENhcnQgPSB0aGlzLnJlY3Vyc2l2ZVJlZHVjZShpdGVtLmNoaWxkcmVuLCBuZXdDb250ZXh0KTtcbiAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGFkZCBhIHBhcmVudCBvYmplY3Qgd2l0aCB0aGlzIG9iamVjdHMgY2hpbGRyZW5cbiAgICAgICAgICBjb25zdCBwYXJlbnQgPSB7XG4gICAgICAgICAgICBsYWJlbDogaXRlbS5sYWJlbCxcbiAgICAgICAgICAgIHBhdGg6IGl0ZW0ucGF0aCxcbiAgICAgICAgICAgIGNvbnRleHQ6IGNvbnRleHQuam9pbignLCAnKSxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBjaGlsZENhcnQuY2hpbGRyZW4sIC8vIHRoaXMgaXMgdGhlIHJlZHVjaW5nIHBhcnQgb2YgdGhpbmdzXG4gICAgICAgICAgICBzZWFyY2hLZXk6IGNoaWxkQ2FydC5zZWFyY2hLZXlzLmpvaW4odGhpcy5TUExJVFRFUikgLy8gb25seSBzZWFyY2hrZXlzIG9mIG5vbi1wYXJlbnQgbm9kZXNcbiAgICAgICAgICB9O1xuICAgICAgICAgIC8vIG9ubHkgYWRkIHRoaXMgcGFyZW50LCBpZiBpdCBoYXMgY2hpbGRyZW5cbiAgICAgICAgICBpZiAoY2hpbGRDYXJ0LmNoaWxkcmVuICYmIGNoaWxkQ2FydC5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjYXJ0LnBhcmVudHMucHVzaChwYXJlbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyB3ZSBnZXQgdGhlIHBhcmVudCBub2RlcyBmcm9tIHRoZSBjaGlsZHJlbiBvZiB0aGlzIGl0ZW0gYW5kIG9ubHkgcGFzcyB0aGVzZSB1cFxuICAgICAgICAgIGNhcnQucGFyZW50cyA9IGNhcnQucGFyZW50cy5jb25jYXQoY2hpbGRDYXJ0LnBhcmVudHMpOyAvLyB0aGUgcmVkdWNlZCBpdGVtcyBhcmUgYmFzaWNhbGx5IHB1c2hlZCB1cCB0byB0aGUgaGlnaGVzdCBsZXZlbFxuICAgICAgICAgIC8vIHdlIGFsc28gYXBwZW5kIHRoZSBjaGlsZGNhcnQga2V5cyB0byB0aGUgcGFyZW50IChmb3Igc2VhcmNoaW5nIHB1cnBvc2VzKVxuICAgICAgICAgIC8vIFRoaXMgaXNuJ3QgbmVjZXNzYXJ5IGFueW1vcmUgYXMgd2Ugb25seSBoYXZlIG9uZSBsZXZlbCBjYXJ0LnNlYXJjaEtleXMgPSBjYXJ0LnNlYXJjaEtleXMuY29uY2F0KGNoaWxkQ2FydC5zZWFyY2hLZXlzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyB0aGlzIGlzIGEgY2hpbGQsIHNvIHdlIGFkZCBpdCB0byB0aGlzIGNhcnRzIGNoaWxkcmVuXG4gICAgICAgICAgaXRlbS5zZWFyY2hLZXkgPSBpdGVtLmxhYmVsLnRvTG93ZXJDYXNlKCk7IC8vIHdlIG1ha2UgdGhlIHNlYXJjaCBrZXkgbG93ZXJjYXNlIGhlcmUgZm9yIGFsbCBjaGlsZHJlblxuICAgICAgICAgIGNhcnQuY2hpbGRyZW4ucHVzaChpdGVtKTtcbiAgICAgICAgICBjYXJ0LnNlYXJjaEtleXMucHVzaChpdGVtLnNlYXJjaEtleSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhcnQ7XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAvLyBzdGFydCB3aXRoIGFuIGVtcHR5IGNhcnRcbiAgICAgICAgcGFyZW50czogW10sXG4gICAgICAgIGNoaWxkcmVuOiBbXSxcbiAgICAgICAgc2VhcmNoS2V5czogW11cbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgLy8gcHJlcGFyZXMgdGhlIHNlYXJjaCBpdGVtc1xuICBwcmVwYXJlU2VhcmNoKGl0ZW1zOiBSdWZTZWFyY2hJdGVtW10pOiAodGVybTogc3RyaW5nKSA9PiBSdWZTZWFyY2hJdGVtW10ge1xuICAgIC8vIHRoZSBnb2FsIGlzIHRvIHJlY3Vyc2l2ZWx5IHBhcnNlIHRoZSB0cmVlIHN0cnVjdHVyZSBmb3IgcGFyZW50cyBvZiBjaGlsZHJlblxuICAgIC8vIGNoaWxkcmVuIGFyZSBub2RlcyB3aXRoIG5vIGNoaWxkcmVuLCBwYXJlbnRzIGFyZSBub2RlcyB3aXRoIGNoaWxkcmVuXG4gICAgY29uc3QgcHJlcGFyZWRJdGVtcyA9IHRoaXMucmVjdXJzaXZlUmVkdWNlKGl0ZW1zLCBbXSk7XG4gICAgLy8gd2UgcmV0dXJuIGEgZnVuY3Rpb24gaGVyZSB0aGF0IHBlcmZvcm1zIHRoZSBzZWFyY2ggb24gdGhlIHByZXBhcmVkIGl0ZW1zXG4gICAgcmV0dXJuIHRlcm0gPT4ge1xuICAgICAgcmV0dXJuIHRoaXMucGVyZm9ybVNlYXJjaChwcmVwYXJlZEl0ZW1zLnBhcmVudHMsIHRlcm0pO1xuICAgIH07XG4gIH1cblxuICAvLyB1c2VkIHRvIGNyZWF0ZSBhIHJlZHVjZWQgdmVyc2lvbiBvZiB3aGF0IGdldHMgZGlzcGxheWVkLCBhbmQgYWxzb1xuICAvLyBkZXRhY2hlcyBmcm9tIHRoZSBvcmlnaW5hbCBvYmplY3RcbiAgY29weVNlYXJjaEl0ZW0oaXRlbTogUnVmU2VhcmNoSXRlbSwgbmV3Q2hpbGRyZW46IFJ1ZlNlYXJjaEl0ZW1bXSk6IFJ1ZlNlYXJjaEl0ZW0ge1xuICAgIHJldHVybiB7XG4gICAgICBsYWJlbDogaXRlbS5sYWJlbCxcbiAgICAgIHBhdGg6IGl0ZW0ucGF0aCxcbiAgICAgIGNvbnRleHQ6IGl0ZW0uY29udGV4dCxcbiAgICAgIGNoaWxkcmVuOiBuZXdDaGlsZHJlblxuICAgIH07XG4gIH1cblxuICAvLyBUaGUgc2VhcmNoIGFzc3VtZXMgdGhhdCB0aGVyZSBlYWNoIGl0ZW0gaW4gdGhlIGFycmF5IG9ubHkgaGFzIG9uZSBsZXZlbCBvZiBjaGlsZHJlblxuICAvLyB0aGlzIGV4cGxpY2l0IHN0cnVjdHVyZSBpcyBjcmVhdGVkIGluIHRoZSBwcmVwYXJlIHNlYXJjaFxuICBwZXJmb3JtU2VhcmNoKGl0ZW1zOiBSdWZTZWFyY2hJdGVtW10sIHRlcm06IHN0cmluZykge1xuICAgIGNvbnN0IHNlYXJjaFRlcm0gPSB0ZXJtLnRvTG93ZXJDYXNlKCk7IC8vIGxvd2VyY2FzZSBzZWFyY2ggdGVybSB2cyBsb3dlcmNhc2Ugc2VhcmNoIGtleVxuICAgIC8vIGNhbGwgdGhlIHJlZHVjZSB0byBvbWl0IG5vbiBtYXRjaGluZyBpdGVtc1xuICAgIHJldHVybiBpdGVtcy5yZWR1Y2UoXG4gICAgICAvLyBuZXdJdGVtcyBpcyB0aGUgcmV0dXJuZWQgdmFsdWUgZnJvbSB0aGUgcHJldiBmdW5jdGlvbiBjYWxsXG4gICAgICAobmV3SXRlbXMsIGl0ZW0pID0+IHtcbiAgICAgICAgLy8gZmlyc3Qgd2UgY2hlY2sgaWYgdGhlIHBhcmVudCBpdGVtIHdpbGwgYmUgYWRkZWQgKGNoZWNraW5nIHRoaXMgaGVyZSBwcmV2ZW50cyB1bm5lY2Vzc2FyeSBsb29waW5nKVxuICAgICAgICBpZiAoaXRlbS5zZWFyY2hLZXkgJiYgaXRlbS5zZWFyY2hLZXkuaW5kZXhPZihzZWFyY2hUZXJtKSA+IC0xKSB7XG4gICAgICAgICAgLy8gZmlsdGVyIHRoZSBjaGlsZHJlblxuICAgICAgICAgIC8vICh3ZSBrbm93IHRoZXJlIGFyZSBjaGlsZHJlbiBhcyB0aGUgc2VhcmNoa2V5IGNvbGxhdGVzIG9ubHkgY2hpbGQga2V5cylcbiAgICAgICAgICBjb25zdCByZWR1Y2VkQ2hpbGRyZW4gPSBpdGVtLmNoaWxkcmVuLmZpbHRlcihjaGlsZCA9PiB7XG4gICAgICAgICAgICByZXR1cm4gY2hpbGQuc2VhcmNoS2V5LmluZGV4T2Yoc2VhcmNoVGVybSkgPiAtMTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvLyB0aGVyZSB3aWxsIGFsd2F5cyBiZSBhdGxlYXN0IG9uZSBjaGlsZCB0aGF0IG1hdGNoZXNcbiAgICAgICAgICAvLyAoYXMgaGF2ZSBhbHJlYWR5IHdlIGNoZWNrZWQgdGhlIGNvbGxhdGVkIHNlYXJjaCBrZXkpXG4gICAgICAgICAgbmV3SXRlbXMucHVzaCh0aGlzLmNvcHlTZWFyY2hJdGVtKGl0ZW0sIHJlZHVjZWRDaGlsZHJlbikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdJdGVtcztcbiAgICAgIH0sXG4gICAgICBbXSAvLyBpbml0aWFsIGVtcHR5IGFycmF5XG4gICAgKTtcbiAgfVxufVxuIl19