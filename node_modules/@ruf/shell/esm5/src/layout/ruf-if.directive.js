import * as tslib_1 from "tslib";
import { ElementRef, ViewContainerRef, TemplateRef, Input, Directive, ChangeDetectorRef } from '@angular/core';
import { BaseDirective, MediaMonitor, StyleUtils } from '@angular/flex-layout';
var FALSY = ['false', false, 0];
var RufIfDirective = /** @class */ (function (_super) {
    tslib_1.__extends(RufIfDirective, _super);
    function RufIfDirective(templateRef, viewContainer, monitor, elRef, styleUtils, changeDetectorRef) {
        var _this = _super.call(this, monitor, elRef, styleUtils) || this;
        _this.templateRef = templateRef;
        _this.viewContainer = viewContainer;
        _this.elRef = elRef;
        _this.styleUtils = styleUtils;
        _this.changeDetectorRef = changeDetectorRef;
        _this.isAlreadyInserted = false;
        return _this;
    }
    Object.defineProperty(RufIfDirective.prototype, "rufIfXs", {
        set: function (val) {
            this._cacheInput('rufIfXs', val);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RufIfDirective.prototype, "rufIfGtXs", {
        set: function (val) {
            this._cacheInput('rufIfGtXs', val);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RufIfDirective.prototype, "rufIfSm", {
        set: function (val) {
            this._cacheInput('rufIfSm', val);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RufIfDirective.prototype, "rufIfGtSm", {
        set: function (val) {
            this._cacheInput('rufIfGtSm', val);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RufIfDirective.prototype, "rufIfMd", {
        set: function (val) {
            this._cacheInput('rufIfMd', val);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RufIfDirective.prototype, "rufIfGtMd", {
        set: function (val) {
            this._cacheInput('rufIfGtMd', val);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RufIfDirective.prototype, "rufIfLg", {
        set: function (val) {
            this._cacheInput('rufIfLg', val);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RufIfDirective.prototype, "rufIfGtLg", {
        set: function (val) {
            this._cacheInput('rufIfGtLg', val);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RufIfDirective.prototype, "rufIfXl", {
        set: function (val) {
            this._cacheInput('rufIfXl', val);
        },
        enumerable: true,
        configurable: true
    });
    RufIfDirective.prototype._getDisplayStyle = function () {
        // this is not used for rufIf, only prevents error from being throw as BaseDirective invokes it
        return 'block';
    };
    RufIfDirective.prototype.ngOnChanges = function (changes) {
        if (changes['rufIf'] != null || this._mqActivation) {
            this._updateWithValue();
        }
    };
    RufIfDirective.prototype.ngOnInit = function () {
        var _this = this;
        this._listenForMediaQueryChanges('rufIf', false, function (changes) {
            _this._updateWithValue(changes.value);
            _this.changeDetectorRef.markForCheck();
        });
        this._updateWithValue();
    };
    RufIfDirective.prototype.ngOnDestroy = function () {
        _super.prototype.ngOnDestroy.call(this);
    };
    RufIfDirective.prototype._updateWithValue = function (value) {
        value = value || this._getDefaultVal('rufIf', false);
        if (this._mqActivation) {
            value = this._mqActivation.activatedInput;
        }
        var shouldShow = this._validateTruthy(value);
        this._update(shouldShow);
    };
    // Insert or remove the template
    RufIfDirective.prototype._update = function (value) {
        if (value && !this.isAlreadyInserted) {
            this.viewContainer.createEmbeddedView(this.templateRef);
            this.isAlreadyInserted = true;
        }
        else if (!value && this.isAlreadyInserted) {
            this.viewContainer.clear();
            this.isAlreadyInserted = false;
        }
    };
    RufIfDirective.prototype._validateTruthy = function (value) {
        return FALSY.indexOf(value) === -1;
    };
    tslib_1.__decorate([
        Input('rufIfXs'),
        tslib_1.__metadata("design:type", Object),
        tslib_1.__metadata("design:paramtypes", [Object])
    ], RufIfDirective.prototype, "rufIfXs", null);
    tslib_1.__decorate([
        Input('rufIfGtXs'),
        tslib_1.__metadata("design:type", Object),
        tslib_1.__metadata("design:paramtypes", [Object])
    ], RufIfDirective.prototype, "rufIfGtXs", null);
    tslib_1.__decorate([
        Input('rufIfSm'),
        tslib_1.__metadata("design:type", Object),
        tslib_1.__metadata("design:paramtypes", [Object])
    ], RufIfDirective.prototype, "rufIfSm", null);
    tslib_1.__decorate([
        Input('rufIfGtSm'),
        tslib_1.__metadata("design:type", Object),
        tslib_1.__metadata("design:paramtypes", [Object])
    ], RufIfDirective.prototype, "rufIfGtSm", null);
    tslib_1.__decorate([
        Input('rufIfMd'),
        tslib_1.__metadata("design:type", Object),
        tslib_1.__metadata("design:paramtypes", [Object])
    ], RufIfDirective.prototype, "rufIfMd", null);
    tslib_1.__decorate([
        Input('rufIfGtMd'),
        tslib_1.__metadata("design:type", Object),
        tslib_1.__metadata("design:paramtypes", [Object])
    ], RufIfDirective.prototype, "rufIfGtMd", null);
    tslib_1.__decorate([
        Input('rufIfLg'),
        tslib_1.__metadata("design:type", Object),
        tslib_1.__metadata("design:paramtypes", [Object])
    ], RufIfDirective.prototype, "rufIfLg", null);
    tslib_1.__decorate([
        Input('rufIfGtLg'),
        tslib_1.__metadata("design:type", Object),
        tslib_1.__metadata("design:paramtypes", [Object])
    ], RufIfDirective.prototype, "rufIfGtLg", null);
    tslib_1.__decorate([
        Input('rufIfXl'),
        tslib_1.__metadata("design:type", Object),
        tslib_1.__metadata("design:paramtypes", [Object])
    ], RufIfDirective.prototype, "rufIfXl", null);
    RufIfDirective = tslib_1.__decorate([
        Directive({
            selector: "\n    [rufIfXs],\n    [rufIfGtXs],\n    [rufIfSm],\n    [rufIfGtSm],\n    [rufIfMd],\n    [rufIfGtMd],\n    [rufIfLg],\n    [rufIfGtLg],\n    [rufIfXl]\n  "
        }),
        tslib_1.__metadata("design:paramtypes", [TemplateRef,
            ViewContainerRef,
            MediaMonitor,
            ElementRef,
            StyleUtils,
            ChangeDetectorRef])
    ], RufIfDirective);
    return RufIfDirective;
}(BaseDirective));
export { RufIfDirective };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicnVmLWlmLmRpcmVjdGl2ZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BydWYvc2hlbGwvIiwic291cmNlcyI6WyJzcmMvbGF5b3V0L3J1Zi1pZi5kaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFFTCxVQUFVLEVBQ1YsZ0JBQWdCLEVBQ2hCLFdBQVcsRUFJWCxLQUFLLEVBQ0wsU0FBUyxFQUFFLGlCQUFpQixFQUM3QixNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBRUwsYUFBYSxFQUNiLFlBQVksRUFDWixVQUFVLEVBQ1gsTUFBTSxzQkFBc0IsQ0FBQztBQUU5QixJQUFNLEtBQUssR0FBRyxDQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFlbEM7SUFBb0MsMENBQWE7SUFnRC9DLHdCQUNVLFdBQTZCLEVBQzdCLGFBQStCLEVBQ3ZDLE9BQXFCLEVBQ1gsS0FBaUIsRUFDakIsVUFBc0IsRUFDdEIsaUJBQW9DO1FBTmhELFlBUUUsa0JBQU0sT0FBTyxFQUFFLEtBQUssRUFBRSxVQUFVLENBQUMsU0FDbEM7UUFSUyxpQkFBVyxHQUFYLFdBQVcsQ0FBa0I7UUFDN0IsbUJBQWEsR0FBYixhQUFhLENBQWtCO1FBRTdCLFdBQUssR0FBTCxLQUFLLENBQVk7UUFDakIsZ0JBQVUsR0FBVixVQUFVLENBQVk7UUFDdEIsdUJBQWlCLEdBQWpCLGlCQUFpQixDQUFtQjtRQXJEeEMsdUJBQWlCLEdBQUcsS0FBSyxDQUFDOztJQXdEbEMsQ0FBQztJQXJERCxzQkFBSSxtQ0FBTzthQUFYLFVBQVksR0FBRztZQUNiLElBQUksQ0FBQyxXQUFXLENBQUMsU0FBUyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ25DLENBQUM7OztPQUFBO0lBR0Qsc0JBQUkscUNBQVM7YUFBYixVQUFjLEdBQUc7WUFDZixJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNyQyxDQUFDOzs7T0FBQTtJQUdE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S0FBSyxDQUFDO1NBQ2hDO0lBQ0gsQ0FBQztJQUVPLHdDQUFlLEdBQXZCLFVBQXdCLEtBQUs7UUFDM0IsT0FBTyxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQ3JDLENBQUM7SUFyR0Q7UUFEQyxLQUFLLENBQUMsU0FBUyxDQUFDOzs7aURBR2hCO0lBR0Q7UUFEQyxLQUFLLENBQUMsV0FBVyxDQUFDOzs7bURBR2xCO0lBR0Q7UUFEQyxLQUFLLENBQUMsU0FBUyxDQUFDOzs7aURBR2hCO0lBR0Q7UUFEQyxLQUFLLENBQUMsV0FBVyxDQUFDOzs7bURBR2xCO0lBR0Q7UUFEQyxLQUFLLENBQUMsU0FBUyxDQUFDOzs7aURBR2hCO0lBR0Q7UUFEQyxLQUFLLENBQUMsV0FBVyxDQUFDOzs7bURBR2xCO0lBR0Q7UUFEQyxLQUFLLENBQUMsU0FBUyxDQUFDOzs7aURBR2hCO0lBR0Q7UUFEQyxLQUFLLENBQUMsV0FBVyxDQUFDOzs7bURBR2xCO0lBR0Q7UUFEQyxLQUFLLENBQUMsU0FBUyxDQUFDOzs7aURBR2hCO0lBOUNVLGNBQWM7UUFiMUIsU0FBUyxDQUFDO1lBQ1QsUUFBUSxFQUFFLDZKQVVUO1NBQ0YsQ0FBQztpREFrRHVCLFdBQVc7WUFDVCxnQkFBZ0I7WUFDOUIsWUFBWTtZQUNKLFVBQVU7WUFDTCxVQUFVO1lBQ0gsaUJBQWlCO09BdERyQyxjQUFjLENBMEcxQjtJQUFELHFCQUFDO0NBQUEsQUExR0QsQ0FBb0MsYUFBYSxHQTBHaEQ7U0ExR1ksY0FBYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIFNpbXBsZUNoYW5nZXMsXG4gIEVsZW1lbnRSZWYsXG4gIFZpZXdDb250YWluZXJSZWYsXG4gIFRlbXBsYXRlUmVmLFxuICBPbkRlc3Ryb3ksXG4gIE9uQ2hhbmdlcyxcbiAgT25Jbml0LFxuICBJbnB1dCxcbiAgRGlyZWN0aXZlLCBDaGFuZ2VEZXRlY3RvclJlZlxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHtcbiAgTWVkaWFDaGFuZ2UsXG4gIEJhc2VEaXJlY3RpdmUsXG4gIE1lZGlhTW9uaXRvcixcbiAgU3R5bGVVdGlsc1xufSBmcm9tICdAYW5ndWxhci9mbGV4LWxheW91dCc7XG5cbmNvbnN0IEZBTFNZID0gWydmYWxzZScsIGZhbHNlLCAwXTtcblxuQERpcmVjdGl2ZSh7XG4gIHNlbGVjdG9yOiBgXG4gICAgW3J1ZklmWHNdLFxuICAgIFtydWZJZkd0WHNdLFxuICAgIFtydWZJZlNtXSxcbiAgICBbcnVmSWZHdFNtXSxcbiAgICBbcnVmSWZNZF0sXG4gICAgW3J1ZklmR3RNZF0sXG4gICAgW3J1ZklmTGddLFxuICAgIFtydWZJZkd0TGddLFxuICAgIFtydWZJZlhsXVxuICBgXG59KVxuZXhwb3J0IGNsYXNzIFJ1ZklmRGlyZWN0aXZlIGV4dGVuZHMgQmFzZURpcmVjdGl2ZSBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzLCBPbkRlc3Ryb3kge1xuICBwcml2YXRlIGlzQWxyZWFkeUluc2VydGVkID0gZmFsc2U7XG5cbiAgQElucHV0KCdydWZJZlhzJylcbiAgc2V0IHJ1ZklmWHModmFsKSB7XG4gICAgdGhpcy5fY2FjaGVJbnB1dCgncnVmSWZYcycsIHZhbCk7XG4gIH1cblxuICBASW5wdXQoJ3J1ZklmR3RYcycpXG4gIHNldCBydWZJZkd0WHModmFsKSB7XG4gICAgdGhpcy5fY2FjaGVJbnB1dCgncnVmSWZHdFhzJywgdmFsKTtcbiAgfVxuXG4gIEBJbnB1dCgncnVmSWZTbScpXG4gIHNldCBydWZJZlNtKHZhbCkge1xuICAgIHRoaXMuX2NhY2hlSW5wdXQoJ3J1ZklmU20nLCB2YWwpO1xuICB9XG5cbiAgQElucHV0KCdydWZJZkd0U20nKVxuICBzZXQgcnVmSWZHdFNtKHZhbCkge1xuICAgIHRoaXMuX2NhY2hlSW5wdXQoJ3J1ZklmR3RTbScsIHZhbCk7XG4gIH1cblxuICBASW5wdXQoJ3J1ZklmTWQnKVxuICBzZXQgcnVmSWZNZCh2YWwpIHtcbiAgICB0aGlzLl9jYWNoZUlucHV0KCdydWZJZk1kJywgdmFsKTtcbiAgfVxuXG4gIEBJbnB1dCgncnVmSWZHdE1kJylcbiAgc2V0IHJ1ZklmR3RNZCh2YWwpIHtcbiAgICB0aGlzLl9jYWNoZUlucHV0KCdydWZJZkd0TWQnLCB2YWwpO1xuICB9XG5cbiAgQElucHV0KCdydWZJZkxnJylcbiAgc2V0IHJ1ZklmTGcodmFsKSB7XG4gICAgdGhpcy5fY2FjaGVJbnB1dCgncnVmSWZMZycsIHZhbCk7XG4gIH1cblxuICBASW5wdXQoJ3J1ZklmR3RMZycpXG4gIHNldCBydWZJZkd0TGcodmFsKSB7XG4gICAgdGhpcy5fY2FjaGVJbnB1dCgncnVmSWZHdExnJywgdmFsKTtcbiAgfVxuXG4gIEBJbnB1dCgncnVmSWZYbCcpXG4gIHNldCBydWZJZlhsKHZhbCkge1xuICAgIHRoaXMuX2NhY2hlSW5wdXQoJ3J1ZklmWGwnLCB2YWwpO1xuICB9XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSB0ZW1wbGF0ZVJlZjogVGVtcGxhdGVSZWY8YW55PixcbiAgICBwcml2YXRlIHZpZXdDb250YWluZXI6IFZpZXdDb250YWluZXJSZWYsXG4gICAgbW9uaXRvcjogTWVkaWFNb25pdG9yLFxuICAgIHByb3RlY3RlZCBlbFJlZjogRWxlbWVudFJlZixcbiAgICBwcm90ZWN0ZWQgc3R5bGVVdGlsczogU3R5bGVVdGlscyxcbiAgICBwcm90ZWN0ZWQgY2hhbmdlRGV0ZWN0b3JSZWY6IENoYW5nZURldGVjdG9yUmVmXG4gICkge1xuICAgIHN1cGVyKG1vbml0b3IsIGVsUmVmLCBzdHlsZVV0aWxzKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBfZ2V0RGlzcGxheVN0eWxlKCk6IHN0cmluZyB7XG4gICAgLy8gdGhpcyBpcyBub3QgdXNlZCBmb3IgcnVmSWYsIG9ubHkgcHJldmVudHMgZXJyb3IgZnJvbSBiZWluZyB0aHJvdyBhcyBCYXNlRGlyZWN0aXZlIGludm9rZXMgaXRcbiAgICByZXR1cm4gJ2Jsb2NrJztcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcbiAgICBpZiAoY2hhbmdlc1sncnVmSWYnXSAhPSBudWxsIHx8IHRoaXMuX21xQWN0aXZhdGlvbikge1xuICAgICAgdGhpcy5fdXBkYXRlV2l0aFZhbHVlKCk7XG4gICAgfVxuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5fbGlzdGVuRm9yTWVkaWFRdWVyeUNoYW5nZXMoJ3J1ZklmJywgZmFsc2UsIChjaGFuZ2VzOiBNZWRpYUNoYW5nZSkgPT4ge1xuICAgICAgdGhpcy5fdXBkYXRlV2l0aFZhbHVlKGNoYW5nZXMudmFsdWUpO1xuICAgICAgdGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICB9KTtcbiAgICB0aGlzLl91cGRhdGVXaXRoVmFsdWUoKTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHN1cGVyLm5nT25EZXN0cm95KCk7XG4gIH1cblxuICBwcml2YXRlIF91cGRhdGVXaXRoVmFsdWUodmFsdWU/OiBzdHJpbmcgfCBudW1iZXIgfCBib29sZWFuKSB7XG4gICAgdmFsdWUgPSB2YWx1ZSB8fCB0aGlzLl9nZXREZWZhdWx0VmFsKCdydWZJZicsIGZhbHNlKTtcbiAgICBpZiAodGhpcy5fbXFBY3RpdmF0aW9uKSB7XG4gICAgICB2YWx1ZSA9IHRoaXMuX21xQWN0aXZhdGlvbi5hY3RpdmF0ZWRJbnB1dDtcbiAgICB9XG5cbiAgICBjb25zdCBzaG91bGRTaG93ID0gdGhpcy5fdmFsaWRhdGVUcnV0aHkodmFsdWUpO1xuICAgIHRoaXMuX3VwZGF0ZShzaG91bGRTaG93KTtcbiAgfVxuXG4gIC8vIEluc2VydCBvciByZW1vdmUgdGhlIHRlbXBsYXRlXG4gIHByaXZhdGUgX3VwZGF0ZSh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSAmJiAhdGhpcy5pc0FscmVhZHlJbnNlcnRlZCkge1xuICAgICAgdGhpcy52aWV3Q29udGFpbmVyLmNyZWF0ZUVtYmVkZGVkVmlldyh0aGlzLnRlbXBsYXRlUmVmKTtcbiAgICAgIHRoaXMuaXNBbHJlYWR5SW5zZXJ0ZWQgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAoIXZhbHVlICYmIHRoaXMuaXNBbHJlYWR5SW5zZXJ0ZWQpIHtcbiAgICAgIHRoaXMudmlld0NvbnRhaW5lci5jbGVhcigpO1xuICAgICAgdGhpcy5pc0FscmVhZHlJbnNlcnRlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgX3ZhbGlkYXRlVHJ1dGh5KHZhbHVlKSB7XG4gICAgcmV0dXJuIEZBTFNZLmluZGV4T2YodmFsdWUpID09PSAtMTtcbiAgfVxufVxuIl19