(function () {
  'use strict';

  angular
    .module('demo-fisBootstrapTable.table')
    .controller('tableServerPagination', tableServerPagination);

  tableServerPagination.$inject = ['$scope',
    'TableDataService'];

  function tableServerPagination($scope,
    TableDataService) {
    'use strict';

    /*
     * hard coding page number for server side implementation as current server side
     * implementation doesn't give total number of records but we need to show total number of
     * pages available on the page control. this can be easily handled by sending total number
     * of records in the response or total number pages available based on the request query
     * parameters
     */
    $scope.numberOfPages = 8;
    $scope.displayDataCollection = [];
    $scope.roles = [];
    $scope.init = function (name) {
      $scope.tablename = name;
    };

    $scope.loadServerData = function (page) {
      TableDataService.getTableContent(page).then(function (data) {
        $scope.tableDataArr = data.tableRowData;

        // make first time sort as sort by first row
        $scope.tableDataArr.sort(function (a, b) {
          return a.data1.localeCompare(b.data1);
        });

        // copy the references (you could clone
        // ie angular.copy but then have to go
        // through a dirty checking for the
        // matches)
        $scope.displayDataCollection = [].concat($scope.rowCollection);
      }, function (ex) {
        alert('Error retrieving the table json data!!', ex);
        // return true;
      });
    };

    $scope.loadServerData(1);

    $scope.showMessage = function showMessage(row) {
      alert('Hi... ' + row.alias);
    };
  }
})();
