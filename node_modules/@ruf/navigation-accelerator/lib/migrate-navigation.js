"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs");
const exec = require("child_process");
const path = require("path");
const chalk_1 = require("chalk");
const templates = require("./files");
function migrateNavigation(options) {
    return __awaiter(this, void 0, void 0, function* () {
        const routes = [];
        const lazyRoutes = [];
        let finalRoutes = [];
        const sidenavData = [];
        const unprocessedItems = [];
        const dasherize = (str = '') => str.replace(/([A-Z]+)/g, ' $1').replace(/([A-Z][a-z])/g, ' $1').replace(/\s+/g, '-').toLowerCase().substr(1);
        const capitalizeFirstLetter = (str) => str.charAt(0).toUpperCase() + str.slice(1);
        const replaceDotsAndDashesWithSpace = (str) => str.replace(/[-.]/g, ' ');
        const convertSpaceToUpperCase = (str) => str.replace(/(?:_| |\b)(\w)/g, (strg, p1) => p1.toUpperCase());
        console.log('RUF Navigation Accelerator Invoked!!!', options.flags);
        fs.readFile(options.flags.pathToNavigation, { encoding: 'utf8' }, (err, data) => {
            const mainNav = JSON.parse(data.toString()).main;
            writeFile('app.module.ts', templates.getAppModuleTs());
            exec.execSync(`ng g module test --project=${options.flags.project} --module=app --force`);
            exec.execSync(`ng g c test --project=${options.flags.project} --module=test --force`);
            writeFile('test/test.component.html', templates.getTestComponentHtml());
            writeFile('test/test.module.ts', templates.getTestModuleTs());
            mainNav.forEach((nav) => {
                readNavObj(nav);
            });
            writeFile('sidenav-item.ts', templates.getSideNavItemTs(sidenavData));
            writeFile('app.component.html', templates.getAppComponentHtml());
            writeFile('app.component.ts', templates.getAppComponentTs());
            writeFile('app-routing.module.ts', templates.getAppRoutingModuleTS(finalRoutes));
        });
        function readNavObj(nav) {
            console.log(chalk_1.default.green(nav.label));
            if (!nav.children && nav.partial) {
                routes.push(`{ path: "${nav.id}", component: TestComponent }`);
                sidenavData.push(`
      {
        label: '${nav.label}',
        path: '/${nav.id}'
      }`);
            }
            else if (nav.children) {
                const childRoutes = [];
                const childSideNavData = [];
                nav.children.forEach((child) => {
                    console.log(chalk_1.default.green('\t', child.label));
                    if (!child.children && child.partial) {
                        childRoutes.push(`
          { path: "${child.id}", component: TestComponent }`);
                        childSideNavData.push(`
          {
            label: '${child.label}',
            path: '/${nav.id}/${child.id}'
          }`);
                    }
                    else if (child.children) {
                        childSideNavData.push(`
          {
            label: '${child.label}',
            path: '/${nav.id}/${child.id}'
          }`);
                        const camelizedChildLabel = camelize(child.label);
                        const dasherizedChildLabel = dasherize(child.label);
                        exec.execSync(`ng g module ${camelizedChildLabel} --project=${options.flags.project} --module=app --routing=true --force`);
                        exec.execSync(`ng g class ${dasherizedChildLabel}/landing.component --skip-tests=true --project=${options.flags.project} --force
          `);
                        const tabRoutesFileName = `${dasherizedChildLabel}.tab-routes`;
                        exec.execSync(`ng g class ${dasherizedChildLabel}/${tabRoutesFileName} --skip-tests=true --project=${options.flags.project} --force
          `);
                        const tabRoutesImportName = convertSpaceToUpperCase(replaceDotsAndDashesWithSpace(tabRoutesFileName));
                        const finalRoutesName = tabRoutesImportName.charAt(0).toLowerCase() + tabRoutesImportName.slice(1);
                        const landingComponentTsContent = templates.getLandingComponentTs(finalRoutesName, dasherizedChildLabel, tabRoutesFileName);
                        const landingComponentFilePath = `${dasherizedChildLabel}/landing.component.ts`;
                        writeFile(landingComponentFilePath, landingComponentTsContent);
                        const innerChildRoutesArr = [];
                        child.children.forEach((innerChild) => {
                            console.log(chalk_1.default.green('\t\t', innerChild.label));
                            const innerChildName = convertSpaceToUpperCase(replaceDotsAndDashesWithSpace(innerChild.id));
                            const finalInnerChildName = innerChildName.charAt(0).toLowerCase() + innerChildName.slice(1);
                            innerChildRoutesArr.push(`
            ${finalInnerChildName}: {
              label: '${innerChild.label}',
              path: '${innerChild.id}'
            }`);
                            if (innerChild.children) {
                                innerChild.children.forEach((innerInnerChild) => {
                                    console.log((chalk_1.default.red('\t\t\t', innerInnerChild.label)));
                                    unprocessedItems.push(innerInnerChild);
                                });
                            }
                        });
                        const tabRouteNameConvertedToUC = convertSpaceToUpperCase(replaceDotsAndDashesWithSpace(tabRoutesFileName));
                        const finalTabRouteName = tabRouteNameConvertedToUC.charAt(0).toLowerCase() + tabRouteNameConvertedToUC.slice(1);
                        const tabRoutesContent = templates.getRouteTabsTs(innerChildRoutesArr, finalTabRouteName);
                        const routesTabFilePath = `${dasherizedChildLabel}/${dasherizedChildLabel}.tab-routes.ts`;
                        writeFile(routesTabFilePath, tabRoutesContent);
                        const innerChildRoutes = [];
                        child.children.forEach((innerChild) => {
                            const innerChildName = convertSpaceToUpperCase(replaceDotsAndDashesWithSpace(innerChild.id));
                            const finalInnerChildName = innerChildName.charAt(0).toLowerCase() + innerChildName.slice(1);
                            innerChildRoutes.push(`{
              path: ${finalTabRouteName}Metadata.${finalInnerChildName}.path,
              component: TestComponent
            }
            `);
                        });
                        const firstInnerChildName = convertSpaceToUpperCase(replaceDotsAndDashesWithSpace(child.children[0].id));
                        const finalFirstInnerChildName = firstInnerChildName.charAt(0).toLowerCase() + firstInnerChildName.slice(1);
                        const routingModuleName = `${capitalizeFirstLetter(replaceDotsAndDashesWithSpace(camelizedChildLabel))}RoutingModule`;
                        const routingFilePath = `${dasherizedChildLabel}/${dasherizedChildLabel}-routing.module`;
                        const routingFileName = `${dasherizedChildLabel}-routing.module`;
                        const moduleName = `${capitalizeFirstLetter(replaceDotsAndDashesWithSpace(camelizedChildLabel))}Module`;
                        const moduleFileName = `${dasherizedChildLabel}/${dasherizedChildLabel}.module`;
                        const routingChildren = templates.getChildRoutingModule(finalTabRouteName, tabRoutesFileName, finalFirstInnerChildName, innerChildRoutes, routingModuleName);
                        writeFile(`${routingFilePath}.ts`, routingChildren);
                        const moduleFileContent = templates.getChildModuleTs(routingModuleName, routingFileName, moduleName);
                        writeFile(`${moduleFileName}.ts`, moduleFileContent);
                    }
                });
                const lazyChildren = [];
                nav.children.forEach((child) => {
                    if (child.children) {
                        lazyChildren.push(`
          {
            "path": "${child.id}",
            loadChildren: () => import('./${dasherize(child.label)}/${dasherize(child.label)}.module').then(m => m.${capitalizeFirstLetter(camelize(child.label))}Module)
          }`);
                    }
                });
                lazyRoutes.push(`
      {
        "path": "${nav.id}",
        "children": [${lazyChildren}
        ]
      }`);
                if (childRoutes.length > 0) {
                    routes.push(`
      {
        path: "${nav.id}",
        component: TestComponent,
        children: [   ${childRoutes}
        ]
      }`);
                }
                else {
                    routes.push(`
      { path: "${nav.id}", component: TestComponent }`);
                }
                sidenavData.push(`
      {
        label: '${nav.label}',
        path: '/${nav.id}',
        children: [${childSideNavData}]
      }`);
            }
            finalRoutes = routes.concat(lazyRoutes);
            writeFile('unprocessed.json', JSON.stringify(unprocessedItems, null, 2));
        }
        function camelize(str) {
            if (str) {
                return str
                    .replace(/(?:^\w|[A-Z]|\b\w)/g, (word, index) => {
                    return index === 0 ? word.toLowerCase() : word.toUpperCase();
                })
                    .replace(/\s+/g, '');
            }
            else {
                return '';
            }
        }
        function writeFile(filePath, content) {
            fs.writeFileSync(path.join(process.cwd(), 'apps', options.flags.path, 'src/app', filePath), content, { encoding: 'utf-8', flag: 'w' });
        }
    });
}
exports.migrateNavigation = migrateNavigation;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWlncmF0ZS1uYXZpZ2F0aW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL21pZ3JhdGUtbmF2aWdhdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQ0EseUJBQXlCO0FBQ3pCLHNDQUFzQztBQUN0Qyw2QkFBNkI7QUFDN0IsaUNBQTBCO0FBRTFCLHFDQUFxQztBQUVyQywyQkFBd0MsT0FBWTs7UUFDbEQsTUFBTSxNQUFNLEdBQWEsRUFBRSxDQUFDO1FBQzVCLE1BQU0sVUFBVSxHQUFhLEVBQUUsQ0FBQztRQUNoQyxJQUFJLFdBQVcsR0FBYSxFQUFFLENBQUM7UUFDL0IsTUFBTSxXQUFXLEdBQWEsRUFBRSxDQUFDO1FBRWpDLE1BQU0sZ0JBQWdCLEdBQVUsRUFBRSxDQUFDO1FBRW5DLE1BQU0sU0FBUyxHQUFHLENBQUMsR0FBRyxHQUFHLEVBQUUsRUFBVSxFQUFFLENBQ3JDLEdBQUcsQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxlQUFlLEVBQUUsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDL0csTUFBTSxxQkFBcUIsR0FBRyxDQUFDLEdBQVcsRUFBVSxFQUFFLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLEVBQUUsR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xHLE1BQU0sNkJBQTZCLEdBQUcsQ0FBQyxHQUFXLEVBQVUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ3pGLE1BQU0sdUJBQXVCLEdBQUcsQ0FBQyxHQUFXLEVBQVUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxJ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