'use strict';

describe('search', function () {
  it('should return the property value if query returns object', inject(function ($filter) {
    var list = [{ value: 1, label: 'A' }, { value: 2, label: 'B' }];
    var search = $filter('search');
    expect(search(list, { value: 2 }, 'label')).toEqual('B');
  }));

  it('should return first matched property value if query matches multiple objects', inject(function ($filter) {
    var list = [{ value: 1, label: 'A' }, { value: 2, label: 'B' }, { value: 1, label: 'C' }];
    var search = $filter('search');
    expect(search(list, { value: 1 }, 'label')).toEqual('A');
  }));

  it('should return property of first object if empty query is sent', inject(function ($filter) {
    var list = [{ value: 1, label: 'A' }, { value: 2, label: 'B' }, { value: 1, label: 'C' }];
    var search = $filter('search');
    expect(search(list, {}, 'label')).toEqual('A');
  }));

  it('should return property of first object if no query is sent', inject(function ($filter) {
    var list = [{ value: 1, label: 'A' }, { value: 2, label: 'B' }, { value: 1, label: 'C' }];
    var search = $filter('search');
    expect(search(list, null, 'label')).toEqual('A');
  }));

  it('should return empty string if query does not match any record', inject(function ($filter) {
    var list = [{ value: 1, label: 'A' }, { value: 2, label: 'B' }, { value: 1, label: 'C' }];
    var search = $filter('search');
    expect(search(list, { value: 10 }, 'label')).toEqual('');
  }));

  it('should return empty string if invalid property name is sent', inject(function ($filter) {
    var list = [{ value: 1, label: 'A' }, { value: 2, label: 'B' }, { value: 1, label: 'C' }];
    var search = $filter('search');
    expect(search(list, { value: 1 }, 'someproperty')).toEqual('');
  }));

  it('should return the entire object matched by query if no property is sent', inject(function ($filter) {
    var list = [{ value: 1, label: 'A' }, { value: 2, label: 'B' }, { value: 1, label: 'C' }];
    var search = $filter('search');
    expect(search(list, { value: 1 })).toEqual({ value: 1, label: 'A' });
  }));
});

