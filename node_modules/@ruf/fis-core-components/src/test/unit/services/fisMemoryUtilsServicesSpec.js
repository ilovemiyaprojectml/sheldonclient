'use strict';

/**
 * Test for all utility service directives.
 *
 */
describe('fisMemoryUtils copyProperties', function () {
  beforeEach(angular.mock.module('fis.core'));

  it('should remove attributes from html elements', function () {
    angular.mock.inject(function ($compile, $rootScope, fisMemoryUtilService) {
      var scope = $rootScope.$new();
      // create element with a child
      var element = $compile('<div><div></div></div>')(scope);
      // now add some attributes to the element and its child
      element.attr('functionToRemove', 'hello');
      var childElement = angular.element(element.children()[0]);
      childElement.attr('childFunctionToRemove', 'helloagain');
      // verify that the attributes are set on the elements
      expect(element.attr('functionToRemove')).toBe('hello');
      expect(childElement.attr('childFunctionToRemove')).toBe('helloagain');
      // purge attributes
      fisMemoryUtilService.purgeAttributes(element);
      // they should now all be gone
      expect(element).toBeDefined();
      expect(element.attr('functionToRemove')).toBeUndefined();
      expect(childElement).toBeDefined();
      expect(childElement.attr('childFunctionToRemove')).toBeUndefined();
    });
  });
});
