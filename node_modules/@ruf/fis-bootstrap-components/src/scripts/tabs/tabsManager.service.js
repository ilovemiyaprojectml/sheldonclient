(function () {
  'use strict';

  angular
    .module('fis.bootstrap.tabs')
    .service('TabsManager', TabsManager);

  TabsManager.$inject = [];

  function TabsManager() {
    'use strict';

    var map = {};
    var tabCounter = 1;

    this.register = function (tabsGroupId, tabs) {
      map[tabsGroupId] = tabs;
    };

    function add(tabsGroupId, newTabTitle, content, cntrl, link) {
      var tabs = map[tabsGroupId];
      if (typeof tabs === 'undefined') {
        return;
      }

      var tab = {};
      tab.title = '{{\'' + newTabTitle + '\'|translate}}';
      tab.id = '.nt' + tabCounter;
      tab.data = content;
      tab.url = link.url;

      tabs.unshift(tab);
      tabCounter++;
      return tab;
    }

    this.addTab = function (tabsGroupId, newTabTitle, htmlOfContent, cntrl, url) {
      return add(tabsGroupId, newTabTitle, htmlOfContent, cntrl, url, false);
    };

    this.addTabAsPartial = function (tabsGroupId, newTabTitle, htmlOfContent, cntrl, partialFileName) {
      return add(tabsGroupId, newTabTitle, htmlOfContent, cntrl, partialFileName, true);
    };

    this.removeTab = function (tabsGroupId, tabPosition) {
      var tabs = map[tabsGroupId];
      if (typeof tabs !== 'undefined' && tabs.length > 2) {
        tabs.splice(tabPosition, 1);
      }
    };
  }
})();
